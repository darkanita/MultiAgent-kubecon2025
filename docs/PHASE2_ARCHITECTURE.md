# Phase 2 Architecture Diagrams

## Current State: Phase 1 (Monolithic)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AKS Cluster                                â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Namespace: multiagent-kubecon-simple                          â”‚ â”‚
â”‚  â”‚                                                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Pod: multiagent-app (Single Container)                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚         FastAPI Application                        â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Port: 8000                                        â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                         â”‚                                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                   â”‚   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â–¼                                                   â–¼   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ TravelManager     â”‚          â”‚  A2A Server      â”‚   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Agent             â”‚          â”‚  /a2a/           â”‚   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ (Orchestrator)    â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚           â”‚                                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚           â”‚ Semantic Kernel Function Calls             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚           â”‚ (NOT MCP Protocol)                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚           â”‚                                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                 â”‚                                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â–¼                 â–¼                                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Currency    â”‚  â”‚  Activity    â”‚                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Agent       â”‚  â”‚  Agent       â”‚                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  (Plugin)    â”‚  â”‚  (Plugin)    â”‚                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚              â”‚  â”‚              â”‚                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ 2 tools   â”‚  â”‚  â€¢ 3 tools   â”‚                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ“‚ MCP Files (Deployed but Inactive):                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚     â€¢ mcp_currency_server.py                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚     â€¢ mcp_activity_server.py                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚     â€¢ mcp_coordinator.py                              â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                         â”‚                                      â”‚ â”‚
â”‚  â”‚                         â–¼                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Service: multiagent-service (LoadBalancer)             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Type: LoadBalancer                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  External IP: 172.168.108.4                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Port: 80 â†’ 8000                                       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Internet     â”‚
                    â”‚   Users        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Characteristics**:
- âœ… Single pod, single container
- âœ… All agents in same process
- âœ… Semantic Kernel internal function calling
- âŒ No MCP protocol active
- âŒ No service-to-service communication
- âŒ Cannot scale agents independently

---

## Target State: Phase 2 (Microservices)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AKS Cluster                                      â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Namespace: multiagent-kubecon-simple                                   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Pod 1: coordinator-service (Coordinator Container)                â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  FastAPI Application + MCP Client                           â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Port: 8000                                                 â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                             â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ TravelManagerAgent (Orchestrator)                       â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ MCPCoordinator (Client)                                 â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ REST API (/api/chat/)                                   â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ A2A Server (/a2a/)                                      â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Web UI (HTML/CSS/JS)                                    â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                       â”‚                                                  â”‚ â”‚
â”‚  â”‚                       â”‚ MCP Protocol over HTTP                           â”‚ â”‚
â”‚  â”‚                       â”‚ (via Kubernetes Service DNS)                     â”‚ â”‚
â”‚  â”‚                       â”‚                                                  â”‚ â”‚
â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚ â”‚
â”‚  â”‚         â”‚             â”‚             â”‚                                   â”‚ â”‚
â”‚  â”‚         â–¼             â–¼             â–¼                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â”‚
â”‚  â”‚  â”‚ Pod 2:       â”‚ â”‚ Pod 3:       â”‚ â”‚ Pod N:       â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ currency-    â”‚ â”‚ activity-    â”‚ â”‚ future       â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ agent        â”‚ â”‚ agent        â”‚ â”‚ agents       â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚MCP Serverâ”‚ â”‚ â”‚ â”‚MCP Serverâ”‚ â”‚ â”‚ â”‚MCP Serverâ”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚HTTP      â”‚ â”‚ â”‚ â”‚HTTP      â”‚ â”‚ â”‚ â”‚HTTP      â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚Wrapper   â”‚ â”‚ â”‚ â”‚Wrapper   â”‚ â”‚ â”‚ â”‚Wrapper   â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚Port: 8001â”‚ â”‚ â”‚ â”‚Port: 8002â”‚ â”‚ â”‚ â”‚Port: 800Xâ”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚      â”‚       â”‚ â”‚      â”‚       â”‚ â”‚      â”‚       â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚      â–¼       â”‚ â”‚      â–¼       â”‚ â”‚      â–¼       â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚ Currency â”‚ â”‚ â”‚ â”‚ Activity â”‚ â”‚ â”‚ â”‚   HR     â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚ Tools:   â”‚ â”‚ â”‚ â”‚ Tools:   â”‚ â”‚ â”‚ â”‚ Tools:   â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚          â”‚ â”‚ â”‚ â”‚          â”‚ â”‚ â”‚ â”‚          â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚ â€¢ get_   â”‚ â”‚ â”‚ â”‚ â€¢ plan_  â”‚ â”‚ â”‚ â”‚ â€¢ search â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   rate   â”‚ â”‚ â”‚ â”‚   acts   â”‚ â”‚ â”‚ â”‚ â€¢ lookup â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚ â€¢ convertâ”‚ â”‚ â”‚ â”‚ â€¢ rest   â”‚ â”‚ â”‚ â”‚          â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚          â”‚ â”‚ â”‚ â”‚ â€¢ attractâ”‚ â”‚ â”‚ â”‚          â”‚ â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â”‚
â”‚  â”‚         â”‚                â”‚                â”‚                            â”‚ â”‚
â”‚  â”‚         â–¼                â–¼                â–¼                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â”‚
â”‚  â”‚  â”‚ Service:     â”‚ â”‚ Service:     â”‚ â”‚ Service:     â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ currency-    â”‚ â”‚ activity-    â”‚ â”‚ future-      â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ agent        â”‚ â”‚ agent        â”‚ â”‚ agent        â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ Type:        â”‚ â”‚ Type:        â”‚ â”‚ Type:        â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ ClusterIP    â”‚ â”‚ ClusterIP    â”‚ â”‚ ClusterIP    â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ Port: 8001   â”‚ â”‚ Port: 8002   â”‚ â”‚ Port: 800X   â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ DNS Name:    â”‚ â”‚ DNS Name:    â”‚ â”‚ DNS Name:    â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ currency-    â”‚ â”‚ activity-    â”‚ â”‚ future-      â”‚                   â”‚ â”‚
â”‚  â”‚  â”‚ agent:8001   â”‚ â”‚ agent:8002   â”‚ â”‚ agent:800X   â”‚                   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  Service: coordinator-service (LoadBalancer)                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Type: LoadBalancer                                            â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  External IP: [NEW-IP]                                         â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Port: 80 â†’ 8000                                               â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ HTTP
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚   Internet     â”‚
                           â”‚   Users        â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Characteristics**:
- âœ… 3+ independent pods
- âœ… Each agent is a separate service
- âœ… MCP protocol for inter-service communication
- âœ… HTTP wrapper over MCP stdio
- âœ… Kubernetes DNS for service discovery
- âœ… Independent scaling per agent
- âœ… Independent deployment per agent

---

## Communication Flow: Phase 1 vs Phase 2

### Phase 1 Flow (Monolithic)

```
User Request
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FastAPI (Port 8000)             â”‚
â”‚                                         â”‚
â”‚  POST /api/chat/message                 â”‚
â”‚         â”‚                               â”‚
â”‚         â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ TravelManager    â”‚                   â”‚
â”‚  â”‚ Agent            â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â”‚                             â”‚
â”‚           â”‚ Semantic Kernel             â”‚
â”‚           â”‚ Function Call               â”‚
â”‚           â”‚ (In-Process)                â”‚
â”‚           â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚                 â”‚                    â”‚
â”‚  â–¼                 â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚Currencyâ”‚  â”‚Activityâ”‚                â”‚
â”‚  â”‚Agent   â”‚  â”‚Agent   â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚      â”‚            â”‚                     â”‚
â”‚      â”‚            â”‚                     â”‚
â”‚      â–¼            â–¼                     â”‚
â”‚  Frankfurter   AI Planning             â”‚
â”‚  API           Logic                   â”‚
â”‚      â”‚            â”‚                     â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                     â”‚
â”‚               â”‚                         â”‚
â”‚               â–¼                         â”‚
â”‚         Response                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
User sees response
```

**Time**: ~1-2 seconds  
**Protocol**: Internal function calls  
**Logs**: `semantic_kernel.kernel`, `semantic_kernel.functions`

---

### Phase 2 Flow (Microservices)

```
User Request
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Coordinator Service (Port 8000)                 â”‚
â”‚                                                         â”‚
â”‚  POST /api/chat/message                                 â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚ TravelManager    â”‚                                   â”‚
â”‚  â”‚ + MCP Client     â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚           â”‚                                             â”‚
â”‚           â”‚ ğŸš€ [MCP] Call via HTTP                     â”‚
â”‚           â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ HTTP POST
            â”‚ http://currency-agent:8001/mcp/call_tool
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Currency Agent Service (Port 8001)              â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚  HTTP Wrapper  â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚          â”‚                                              â”‚
â”‚          â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚  MCP Server    â”‚                                     â”‚
â”‚  â”‚  convert_amountâ”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚          â”‚                                              â”‚
â”‚          â–¼                                              â”‚
â”‚    Frankfurter API                                      â”‚
â”‚          â”‚                                              â”‚
â”‚          â”‚ Result: 86.85 EUR                            â”‚
â”‚          â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ âœ… [MCP] Return result
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Coordinator Service                             â”‚
â”‚                                                         â”‚
â”‚  Receives MCP response                                  â”‚
â”‚           â”‚                                             â”‚
â”‚           â”‚ ğŸš€ [MCP] Call via HTTP                     â”‚
â”‚           â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ HTTP POST
            â”‚ http://activity-agent:8002/mcp/call_tool
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Activity Agent Service (Port 8002)              â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚  HTTP Wrapper  â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚          â”‚                                              â”‚
â”‚          â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚  MCP Server    â”‚                                     â”‚
â”‚  â”‚  suggest_acts  â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚          â”‚                                              â”‚
â”‚          â–¼                                              â”‚
â”‚    AI Planning Logic                                    â”‚
â”‚          â”‚                                              â”‚
â”‚          â”‚ Result: [Eiffel, Louvre...]                 â”‚
â”‚          â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ âœ… [MCP] Return result
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Coordinator Service                             â”‚
â”‚                                                         â”‚
â”‚  Aggregates results                                     â”‚
â”‚           â”‚                                             â”‚
â”‚           â–¼                                             â”‚
â”‚     Final Response                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
User sees response
```

**Time**: ~2-3 seconds (network overhead)  
**Protocol**: MCP over HTTP  
**Logs**: `ğŸš€ [MCP] Calling tool`, `âœ… [MCP] Tool executed`

---

## Network Topology

### Phase 2 Service Communication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Kubernetes Network                         â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Service Discovery (DNS)                         â”‚ â”‚
â”‚  â”‚                                                  â”‚ â”‚
â”‚  â”‚  â€¢ currency-agent.multiagent-kubecon-simple     â”‚ â”‚
â”‚  â”‚    â†’ 10.0.x.x:8001 (ClusterIP)                  â”‚ â”‚
â”‚  â”‚                                                  â”‚ â”‚
â”‚  â”‚  â€¢ activity-agent.multiagent-kubecon-simple     â”‚ â”‚
â”‚  â”‚    â†’ 10.0.y.y:8002 (ClusterIP)                  â”‚ â”‚
â”‚  â”‚                                                  â”‚ â”‚
â”‚  â”‚  â€¢ coordinator-service.multiagent-kubecon-simpleâ”‚ â”‚
â”‚  â”‚    â†’ 10.0.z.z:8000 (LoadBalancer)               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  Network Policies (Optional):                         â”‚
â”‚  â€¢ Allow: coordinator â†’ currency-agent                â”‚
â”‚  â€¢ Allow: coordinator â†’ activity-agent                â”‚
â”‚  â€¢ Deny:  currency-agent â†’ activity-agent (isolated) â”‚
â”‚  â€¢ Deny:  agents â†’ internet (except Coordinator)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scaling Strategy

### Phase 1 (Monolithic) - Limited Scaling

```
Scale Up:
  1 replica â†’ 3 replicas

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All-in- â”‚  â”‚ All-in- â”‚  â”‚ All-in- â”‚
â”‚ one Pod â”‚  â”‚ one Pod â”‚  â”‚ one Pod â”‚
â”‚         â”‚  â”‚         â”‚  â”‚         â”‚
â”‚ Full    â”‚  â”‚ Full    â”‚  â”‚ Full    â”‚
â”‚ App     â”‚  â”‚ App     â”‚  â”‚ App     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ Problem: Scales everything, even if only
           currency agent needs more capacity
```

### Phase 2 (Microservices) - Independent Scaling

```
Scale Only What You Need:

Coordinator:        Currency Agent:      Activity Agent:
  1 replica           3 replicas           1 replica
                      (High demand)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Coordi-   â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚Currency  â”‚         â”‚Activity  â”‚
â”‚nator     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚Agent     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚Currency  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚Currency  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Benefit: Scale only currency agent
           Saves resources
           Targeted performance improvement
```

Commands:
```bash
# Scale currency agent for high demand
kubectl scale deployment currency-agent --replicas=3 -n multiagent-kubecon-simple

# Scale activity agent separately
kubectl scale deployment activity-agent --replicas=2 -n multiagent-kubecon-simple

# Coordinator can stay at 1 replica (orchestrator only)
```

---

## Deployment Strategy

### Blue-Green Deployment

```
Phase 1 (Blue) stays running while Phase 2 (Green) is deployed:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AKS Cluster                        â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Blue (Phase 1)    â”‚    â”‚  Green (Phase 2)   â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚                    â”‚    â”‚                    â”‚  â”‚
â”‚  â”‚  monolithic-app    â”‚    â”‚  coordinator       â”‚  â”‚
â”‚  â”‚  (1 pod)           â”‚    â”‚  currency-agent    â”‚  â”‚
â”‚  â”‚                    â”‚    â”‚  activity-agent    â”‚  â”‚
â”‚  â”‚  External IP:      â”‚    â”‚                    â”‚  â”‚
â”‚  â”‚  172.168.108.4     â”‚    â”‚  External IP:      â”‚  â”‚
â”‚  â”‚                    â”‚    â”‚  172.168.x.x       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                          â”‚              â”‚
â”‚           â”‚                          â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                          â”‚
            â”‚                          â”‚
      Test with               Test with
      old IP                  new IP
      
1. Deploy Green (Phase 2) alongside Blue
2. Test Green thoroughly
3. Switch DNS/traffic to Green
4. Keep Blue for 24h (rollback insurance)
5. Delete Blue once confident
```

Commands:
```bash
# Deploy Phase 2 (doesn't affect Phase 1)
kubectl apply -f manifests/microservices/ -n multiagent-kubecon-simple

# Test Phase 2
NEW_IP=$(kubectl get svc coordinator-service -n multiagent-kubecon-simple -o jsonpath='{.status.loadBalancer.ingress[0].ip}')
curl http://${NEW_IP}/health

# If successful, delete Phase 1
kubectl delete -f manifests/deployment.yaml -n multiagent-kubecon-simple
```

---

## Cost Analysis

### Phase 1 Resources

```
1 Pod:
  - Memory: 512Mi
  - CPU: 500m
  
Total: 512Mi memory, 500m CPU
```

### Phase 2 Resources

```
3 Pods:
  - Coordinator: 512Mi, 500m
  - Currency:    256Mi, 200m
  - Activity:    256Mi, 200m
  
Total: 1024Mi memory, 900m CPU

Cost Increase: ~2x
Benefit: Independent scaling, better isolation
```

### Optimized Phase 2

```
3 Pods (Optimized):
  - Coordinator: 256Mi, 250m (reduced - less work)
  - Currency:    128Mi, 100m (lightweight)
  - Activity:    128Mi, 100m (lightweight)
  
Total: 512Mi memory, 450m CPU

Cost Increase: ~10%
Benefit: Same as above, cost-efficient
```

---

## Summary

| Aspect | Phase 1 (Monolithic) | Phase 2 (Microservices) |
|--------|---------------------|------------------------|
| **Pods** | 1 | 3+ |
| **Services** | 1 (LoadBalancer) | 3+ (1 LB + N ClusterIP) |
| **Protocol** | Internal functions | MCP over HTTP |
| **Scaling** | All-or-nothing | Per-agent |
| **Deployment** | Single unit | Independent units |
| **Isolation** | None | Process-level |
| **Cost** | Lower | Slightly higher |
| **Complexity** | Low | Medium |
| **Flexibility** | Low | High |
| **Observability** | Basic | Advanced (per-service) |

---

## Next: Start Phase 2

Ready to implement? Follow these guides:

1. **Detailed Plan**: `docs/PHASE2_IMPLEMENTATION_PLAN.md`
2. **Quick Checklist**: `docs/PHASE2_CHECKLIST.md`
3. **This Architecture**: `docs/PHASE2_ARCHITECTURE.md`

Estimated time: **4-6 hours**  
Difficulty: **â­â­â­â­** (Intermediate-Advanced)

Good luck! ğŸš€
